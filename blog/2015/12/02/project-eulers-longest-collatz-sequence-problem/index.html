
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Project Euler's Longest Collatz Sequence Problem - Heather's Technical Blog</title>
  <meta name="author" content="Heather Lim">

  
  <meta name="description" content="Project Euler had a problem I found quite fun. The challenge was to find a number up to one million that had the longest collatz sequence. The link &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://heatherlim.github.io/blog/2015/12/02/project-eulers-longest-collatz-sequence-problem">
  <link href="/favicon.ico" rel="icon">
  
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Heather's Technical Blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   class="no-sidebar"  >
  <header role="banner"><hgroup>
  <h1>Heather's Technical Blog</h1>
  
    <h2><a href="/">Code Stuff</a></h2>
  
</hgroup>

</header>
  <nav role="navigation">
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:heatherlim.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Project Euler's Longest Collatz Sequence Problem</h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-12-02T22:40:51-05:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Project Euler had a problem I found quite fun. The challenge was to find a number up to one million that had the longest collatz sequence.</p>

<p>The link to the problem can be found <a href = "https://projecteuler.net/problem=14">HERE</a></p>

<p>To summarize, if we follow these two rules:</p>

<p>n → n/2 (n is even)
n → 3n + 1 (n is odd)</p>

<p>The idea is that the final number will always end at 1.</p>

<p>So for example if n was 13&hellip;</p>

<p>13 → 40 → 20 → 10 → 5 → 16 → 8 → 4 → 2 → 1</p>

<p>That is the sequence we will get. So how could we find a way to find which number between one and a million would have the longest sequence?</p>

<p>First, there are four methods that would create my collatz sequence.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>def even_next(n)
</span><span class='line'>  n/2
</span><span class='line'>end
</span><span class='line'>
</span><span class='line'>def odd_next(n)
</span><span class='line'>  3*n + 1
</span><span class='line'>end
</span><span class='line'>
</span><span class='line'>def next_value(n)
</span><span class='line'>  if n.even?
</span><span class='line'>    even_next(n)
</span><span class='line'>  else
</span><span class='line'>    odd_next(n)
</span><span class='line'>  end
</span><span class='line'>end
</span><span class='line'>
</span><span class='line'>def collatz(n)
</span><span class='line'>  array = []
</span><span class='line'>  until array.last == 1 do
</span><span class='line'>    if array.empty?
</span><span class='line'>      array &lt;&lt; n
</span><span class='line'>    else
</span><span class='line'>      array &lt;&lt; next_value(array.last)
</span><span class='line'>    end
</span><span class='line'>  end
</span><span class='line'>  array
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<p><strong>even_next</strong> and <strong>odd_next</strong> decide what to do when a number is odd or even. <strong>next_value</strong> decides whether to run <strong>even_next</strong> or <strong>odd_next</strong> by checking if the number is even or odd. and the method <strong>collatz</strong> brings it all together. It will keep using the <strong>next_value</strong> method and pushing the result into an array until the final number of the array is 1.</p>

<p>Now the next step of the problem is to find out what the longest sequence is. This is my initial solution:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>def longest_collatz
</span><span class='line'>  arrayLimit = (1..1000000).to_a
</span><span class='line'>  collatzArray = []
</span><span class='line'>  arrayLimit.each do |number|
</span><span class='line'>    if collatzArray.empty?
</span><span class='line'>      collatzArray &lt;&lt; collatz(number)
</span><span class='line'>    elsif collatzArray.flatten.length &lt; collatz(number).length
</span><span class='line'>      collatzArray &lt;&lt; collatz(number)
</span><span class='line'>      collatzArray.shift
</span><span class='line'>    end
</span><span class='line'>  end
</span><span class='line'>  return collatzArray.last[0]
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<p>While it does work, it took about a minute to run!</p>

<p>Not exactly ideal. So why did it take so long?</p>

<p>Firstly, there are a lot of redundant steps. Each time my iterator runs, it shovels in a whole collatz sequence, then when it runs again, it will compare the next number&rsquo;s collatz sequence with the one already in collatzArray. If it is longer, it will then delete the shorter sequence in the array. If the sequence is shorter, it then does not push it into the array. Finally, it would look at the first element (the starting number) of the final result.</p>

<p>One of my classmates had a different and more elegant solution:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>def longest_collatz
</span><span class='line'> collatz_sequence = (1...1000000).map {|n| [collatz(n).length, n] }
</span><span class='line'> collatz_sequence.max[1]
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<p>One major difference is that he sorts it by length at the end. While mine made a sequence, compared and deleted depending on the next starting number. This way of solving it cuts down the time from my original solution&rsquo;s 50-ish seconds to about 30-ish seconds. It also made more sense to me. The problem is only asking for the starting number of the longest sequence. It isn&rsquo;t actually asking for the longest sequence. While my final array would hold the longest sequence, this solution would just hold the starting number and length of the sequence.</p>

<p>However, there are also more ways to cut down on processing time.</p>

<p>For example, there is no real need to keep recalculating the collatz sequence for each number to a million as this image illustrates:</p>

<p><img src = "http://martin-thoma.com/images/2013/05/collatz-graph.png"></p>

<p>Once we hit a number we have calculated before, for example&hellip; 26&hellip; we can see that the sequence is already known so we do not have to calculate what the next number is going to be. So by extension, we can just add the length of that already calculated sequence to our sequence length before it hits that repeated number.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn"><a href="/about" title="About the author (Heather Lim)" rel="author">Heather Lim</a></span></span>

      








  


<time datetime="2015-12-02T22:40:51-05:00" pubdate data-updated="true"></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/flatiron-school/'>flatiron school</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://heatherlim.github.io/blog/2015/12/02/project-eulers-longest-collatz-sequence-problem/" data-via="" data-counturl="http://heatherlim.github.io/blog/2015/12/02/project-eulers-longest-collatz-sequence-problem/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2015/11/09/methods-of-sorting/" title="Previous Post: Methods of Sorting and a Bit of Trailing Around from There">&laquo; Methods of Sorting and a Bit of Trailing Around from There</a>
      
      
    </p>
  </footer>
</article>

</div>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Heather Lim -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
